<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/GraphStyles/stylesheet.css" />
  <link rel="shortcut icon" href="https://p.sfx.ms/about/v20/non-localizable/img/chrome/favicon.ico" />
</head>
<body>

<div id="holder">

<!-- HTML Page Content Start -->

<div class="container wrapper" id="body">
    <div class="row">
        <div class="col-md-9">
            <h1 id="calling-microsoft-graph-api">Calling Microsoft Graph API</h1>
<p><em><strong>Applies to:</strong> Office 365</em></p>
<p>In this article:</p>
<ul>
<li>
<a href="#msg_calling_rest_api">Call Microsoft Graph API service via REST</a>
<ul>
<li><a href="#msg_metadata">Microsoft Graph API metadata</a></li>
<li><a href="#msg_nav_from_set_to_member">Navigation from a tenant-level entity set to a member</a> </li>
<li><a href="#msg_proj_from_entity_to_props">Projection from an entity to a subset of its properties</a> </li>
<li><a href="#msg_proj_from_entities_to_props">Projection from an entity set to properties set</a></li>
<li><a href="#msg_traversal_via_relationship">Traversal to another resource by the like-named relationship</a></li>
<li><a href="#msg_filter_query_option">Filtering with a query option</a></li>
<li><a href="#msg_calling_actions">Calling OData actions and functions</a> </li>
</ul>
</li>
</ul>
<p>&lt;a name=&quot;msg_call_api_service&quot;&gt; </a></p>
<h3 id="call-microsoft-graph-api-service-via-rest">Call Microsoft Graph API service via REST</h3>
<p>To access and manipulate a Microsoft Graph API resource, you call and specify the resource URLs using one of the following operations permitted on the resource.   </p>
<ul>
<li>GET</li>
<li>POST</li>
<li>PATCH</li>
<li>PUT</li>
<li>DELETE </li>
</ul>
<p>All Microsoft Graph API requests use the following root URL:</p>
<pre><code>    https://graph.microsoft.com/{version}/{tenant}
</code></pre>

<p>In this URL:
- <code>https://graph.microsoft.com</code> is the Microsoft Graph API endpoint
- <code>{version}</code> is the target service version, for example, <code>v1.0</code> or <code>beta</code>.
- <code>{tenant}</code> is the Office 365 tenant specified in one of the following ways:
  - The tenant ID (GUID)
  - A domain name for the tenant, for example, contoso.onmicrosoft.com
  - The alias <code>me</code>, which resolves to the tenant of the signed-in user
  - The alias <code>myOrganization</code>, which resolves to the tenant of the organization signed-in user</p>
<p>For example, if your tenant domain is <code>https://contoso.onmicrosoft.com</code>, and you are targeting the beta 
version of the service, you can send requests to <code>https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com</code>.</p>
<p>&lt;a name=&quot;msg_metadata&quot;&gt; </a></p>
<h3 id="microsoft-graph-api-metadata">Microsoft Graph API metadata</h3>
<p>The service document ($metadata) is published at the service root. For example, you can view the service document for the v1.0 and beta versions via the following URLs.</p>
<p>Microsoft Graph API <code>v1.0</code> metadata.</p>
<pre><code>    https://graph.microsoft.com/v1.0/$metadata
</code></pre>

<p>Microsoft Graph API `beta metadata.</p>
<pre><code>    https://graph.microsoft.com/beta/$metadata
</code></pre>

<p>The metadata allows you to see entities, entity types and sets, and enums of the Microsoft Graph REST API. Using the metadata and readily available third-party tools, you can create serialized objects and generate client libraries for simplified 
use of the REST API.  </p>
<p>A resource URL is determined by the Microsoft Graph API entity data model. The prescription is outlined in the entity metadata schema ($metadata). </p>
<p>The path URL resource names and query parameters are case insensitive. However, values you assign, entity IDs, and 
other base64 encoded values are case sensitive.</p>
<p>A few basic programming patterns calls to the API are shown in the following section.</p>
<p>&lt;a name=&quot;msg_nav_from_set_to_member&quot;&gt; </a></p>
<h3 id="navigation-from-a-set-to-a-member">Navigation from a set to a member</h3>
<p>To view the information about a user, you get the <code>User</code> entity from the <code>users</code> collection on the tenant. To do so, you can
navigate from the tenant to users and then to the specific user identified by its identifier, using an HTTPS GET request. For a <code>User</code> entity, either the <code>objectId</code> or <code>userPrincipalName</code> property may be used as the identifier. The following example request uses the <code>userPrincipalName</code> value as the user's Id. </p>
<pre><code class="no-highlight">GET https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/users/john.doe@contoso.onmicrosoft.com HTTP/1.1
Authorization : Bearer &lt;access_token&gt;
</code></pre>

<p>If successful, you should get a 200 OK response containing the user resource representation in the payload, as shown as follows:</p>
<pre><code class="no-highlight">HTTP/1.1 200 OK
content-type: application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
server: Microsoft-IIS/8.5
content-length: 982

{
    &quot;@odata.context&quot;: &quot;https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/$metadata#users/$entity&quot;,
    &quot;objectType&quot;: &quot;User&quot;,
    &quot;objectId&quot;: &quot;c95e3b3a-c33b-48da-a6e9-eb101e8a4205&quot;,
    &quot;city&quot;: &quot;Redmond&quot;,
    &quot;country&quot;: &quot;USA&quot;,
    &quot;department&quot;: &quot;Help Center&quot;,
    &quot;dirSyncEnabled&quot;: null,
    &quot;displayName&quot;: &quot;John Doe&quot;,
    &quot;givenName&quot;: &quot;John&quot;,
    &quot;userPrincipalName&quot;: &quot;Johndoe@contoso.onmicrosoft.com&quot;,

    ... 
}
</code></pre>

<p>&lt;a name=&quot;msg_proj_from_entity_to_props&quot;&gt; </a></p>
<h3 id="projection-from-an-entity-to-properties">Projection from an entity to properties</h3>
<p>To retrieve only the user's biographical data, such as the user's provided <em>About me</em> description and their skill set, you can add the $select query option to the previous request. For example,</p>
<pre><code class="no-highlight">GET https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/users/john.doe@contoso.onmicrosoft.com?$select=AboutMe,Skills HTTP/1.1
Authorization : Bearer &lt;access_token&gt;
</code></pre>

<p>The successful response returns the 200 OK status and a payload of the following format:</p>
<pre><code class="no-highlight">HTTP/1.1 200 OK
content-type: application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
odata-version: 4.0
content-length: 169

{
    &quot;@odata.context&quot;: &quot;https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/$metadata#users/$entity&quot;,
    &quot;AboutMe&quot;: &quot;A cool and nice guy.&quot;,
    &quot;Skills&quot;: [
        &quot;n-Lingual&quot;,
        &quot;private speaking&quot;,
        &quot;doodling&quot;
    ]
}
</code></pre>

<p>Here, instead of the entire property sets on the <code>User</code> entity, only the <code>AboutMe</code> and <code>Skills</code> properties, are returned.</p>
<p>&lt;a name=&quot;msg_traversal_via_relationship&quot;&gt; </a></p>
<h3 id="traversal-to-another-resource-via-relationship">Traversal to another resource via relationship</h3>
<p>A manager holds a <code>directReports</code> relatioinship with  the other users reporting to him or her. To query the list of the direct reports of a user, you can use the following HTTPS GET request to navigate to the intended target via relationship traversal. </p>
<pre><code class="no-highlight">GET https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/users/john.doe@contoso.onmicrosoft.com/directReports HTTP/1.1
Authorization : Bearer &lt;access_token&gt;
</code></pre>

<p>The successful response returns the 200 OK status and a payload of the following format:</p>
<pre><code class="no-highlight">HTTP/1.1 200 OK
content-type: application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
odata-version: 4.0
content-length: 152
    
{
    &quot;@odata.context&quot;: &quot;https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/$metadata#users('johndoe%40contoso.onmicrosoft.com')/directReports&quot;,
    &quot;value&quot;: []
}
</code></pre>

<p>In this case, the user is not a manager or team lead and has no direct reports.</p>
<p>Similarly, you can follow a relationship to navigate to related resources provisioned from another service. For example, the <code>User =&gt; Messages</code> relationship enables graph traversal from an Azure AD node to an Exchange Online node. The below example show how to do this in a REST API call:</p>
<pre><code class="no-highlight">GET https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/users/messages HTTP/1.1
Authorization : Bearer &lt;access_token&gt;
</code></pre>

<p>The successful response returns the 200 OK status and a payload of the following format:</p>
<pre><code class="no-highlight">HTTP/1.1 200 OK
content-type: application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
odata-version: 4.0
content-length: 147
    
{
    &quot;@odata.context&quot;: &quot;https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/$metadata#users('johndoe%40contoso.onmicrosoft.com')/messages&quot;,
    &quot;value&quot;: []
}
</code></pre>

<p>&lt;a name=&quot;msg_proj_from_entities_to_props&quot; &gt; </a> </p>
<h3 id="projection-from-entities-to-properties">Projection from entities to properties</h3>
<p>In addition to projection from a single entity to its properties, you can also apply the similar <code>$select</code> query option to an entity collection to project them to a collection of some of their properties. For example, to query the name and type of the signed-in user's files, you can submit the following HTTPS GET request:</p>
<pre><code class="no-highlight">GET https://graph.microsoft.com/v1.0/me/files?$select=name,type HTTP/1.1
Authorization : Bearer &lt;access_token&gt;
</code></pre>

<p>The successful response returns a 200 OK status code and a payload containing the names and types of the shared files, as shown in the following example:</p>
<pre><code class="no-highlight">    {
      &quot;@odata.context&quot;: &quot;https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/$metadata#users('johndoe@contoso.onmicrosoft.com')/files&quot;,
      &quot;value&quot;: [
        {
          &quot;@odata.id&quot;: &quot;users/johndoe@contoso.onmicrosoft.com/files/01EKT655BZNCMKTXXVPREY7G2HYHLWC7R3&quot;,
          &quot;id&quot;: &quot;01EKT655BZNCMKTXXVPREY7G2HYHLWC7R3&quot;,
          &quot;name&quot;: &quot;Shared with Everyone&quot;,
          &quot;type&quot;: &quot;Folder&quot;,
          &quot;#Microsoft.Graph.copy&quot;: {
            &quot;title&quot;: &quot;Microsoft.Graph.copy&quot;,
            &quot;target&quot;: &quot;https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/users/johndoe@contoso.onmicrosoft.com/files/01EKT655BZNCMKTXXVPREY7G2HYHLWC7R3/Microsoft.Graph.Item/Microsoft.Graph.copy&quot;
          },
          &quot;#Microsoft.Graph.content&quot;: {
            &quot;title&quot;: &quot;Microsoft.Graph.content&quot;,
            &quot;target&quot;: &quot;https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/users/johndoe@contoso.onmicrosoft.com/files/01EKT655BZNCMKTXXVPREY7G2HYHLWC7R3/Microsoft.Graph.Item/Microsoft.Graph.content&quot;
          }
        }
      ]
    }
</code></pre>

<p>From the root folder, the <em>Shared with Everyone</em> folder is shared by default. 
Users can add and share other files or folders. In this example, the user has not shared any other folders.</p>
<p>&lt;a name=&quot;msg_filter_query_option&quot;&gt; </a></p>
<h3 id="query-a-subset-of-users-with-the-filtering-query-option">Query a subset of users with the filtering query option</h3>
<p>To find the employees of a specific job title within an organization, you can navigate from the organization's tenant to the users collection and then specify a $filter query option. An example is shown as follows:</p>
<pre><code class="no-highlight">GET https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/users/?$filter=jobTitle+eq+%27Helper%27 HTTP/1.1
Authorization : Bearer &lt;access_token&gt;
</code></pre>

<p>The successful response returns the 200 OK status code and a list of users with the specified job title (<code>'Helper'</code>), as shown in the following example:</p>
<pre><code class="no-highlight">HTTP/1.1 200 OK
content-type: application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
odata-version: 4.0
content-length: 986

{
    &quot;@odata.context&quot;: &quot;https://graph.microsoft.com/v1.0/contoso.onmicrosoft.com/$metadata#users&quot;,
    &quot;value&quot;: [
        {
            &quot;objectType&quot;: &quot;User&quot;,
            &quot;objectId&quot;: &quot;c95e3b3a-c33b-48da-a6e9-eb101e8a4205&quot;,
            &quot;city&quot;: &quot;Redmond&quot;,
            &quot;country&quot;: &quot;USA&quot;,
            &quot;department&quot;: &quot;Help Center&quot;,
            &quot;dirSyncEnabled&quot;: null,
            &quot;displayName&quot;: &quot;Helping hand&quot;,
            &quot;facsimileTelephoneNumber&quot;: null,
            &quot;givenName&quot;: &quot;help&quot;,
            &quot;immutableId&quot;: null,
            &quot;jobTitle&quot;: &quot;Helper&quot;,
            ......
            &quot;mailNickname&quot;: &quot;help&quot;,
            &quot;mobile&quot;: null,
            &quot;onPremisesSecurityIdentifier&quot;: null,
            &quot;otherMails&quot;: [
                &quot;janedoe@contoso.onmicrosoft.com&quot;
            ],
            ......
            &quot;surname&quot;: &quot;hand&quot;,
            &quot;usageLocation&quot;: &quot;US&quot;,
            &quot;userPrincipalName&quot;: &quot;help@contoso.onmicrosoft.com&quot;,
            &quot;userType&quot;: &quot;Member&quot;
        }
    ]
}
</code></pre>

<p>It appears that the returned user has a unique job title in her organization. </p>
<p>&lt;a name=&quot;msg_calling_actions&quot;&gt; </a></p>
<h3 id="calling-odata-actions-or-functions">Calling OData actions or functions</h3>
<p>The Microsoft Graph API also supports OData actions and functions to manipulate the resources. 
For example, the following HTTPS POST request lets the signed-in user (<code>me</code>) copy a file (&quot;test3.txt&quot;) from a folder (<code>&quot;&lt;id_1&gt;&quot;</code>) to another folder (<code>&quot;&lt;id_2&gt;&quot;</code>). </p>
<pre><code class="no-highlight">POST https://graph.microsoft.com/v1.0/me/files/&lt;id_1&gt;/Copy HTTP/1.1
authorization: bearer &lt;access_token&gt;
content-type: application/json
content-length: 96

{
    &quot;destFolderId&quot; : &quot;&lt;id_2&gt;&quot;,
    &quot;newName&quot; : &quot;test3.txt&quot;
}
</code></pre>

<p>The request payload contains the input to the <code>Microsoft.Graph.Copy</code> action, which is also defined in the $metadata.</p>
<p>With a single unified endpoint, the Microsoft Graph API simplifies the application programming interface for all the Office 365 services as well and the Azure AD service. As a result, the boundaries of the otherwise silo-ed services disappear. As an app developer, you are no longer required to keep track of the data sources and to implement custom interfaces between various data sources. </p>
<h2 id="additional-resources">Additional Resources</h2>
<ul>
<li><a href="http://dev.office.com/hands-on-labs/4585" target="_blank">Hands on lab: Deep dive into the Office 365 unified API</a></li>
</ul>

        </div>        
    </div>
</div>
<!-- HTML Page Content End -->

</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>  
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>  
   
</body>  
</html>  




